---
import PageLayout from "../../layouts/PageLayout.astro";
import { getUserProjects } from "../../server/projects";
import GithubLogin from "../../components/solid/GithubLogin";
const user = Astro.locals.user;

const projects = user ? await getUserProjects(user.id) : [];
const codebases = projects
  .filter((p) => p.visibility != "DELETED")
  .map((p) => p.project_id);
// const deleted = projects.filter((p) => p.visibility == "DELETED");
//
const keywords = [
  // One-word keywords
  "projects",
  "management",
  "github",
  "tasks",
  "milestones",

  // Two-word keywords
  "project management",
  "github integration",
  "task tracking",
  "code scanning",
  "project updates",
  "project visibility",
  "task automation",
  "project milestones",
  "project goals",
  "development progress",
  "project links",

  // Three-word keywords
  "github project management",
  "codebase task tracking",
  "project milestone tracking",
  "project visibility tools",
  "development project management"
];
---

<PageLayout title="Projects - devpad" description="Manage your development projects effortlessly with devpad. Track progress, link GitHub repositories, scan codebases for tasks, and centralize project visibility, milestones, and updatesâ€”all in one place." keywords={keywords} canonical="https://devpad.tools/project">
  <main>
    {
      user && (
        <div>
          <section>
            <h3>projects</h3>
            <ul>
              {codebases.map((c) => (
                <li>
                  <a href={`project/${c}`}>{c}</a>
                </li>
              ))}
            </ul>
            <br />
          </section>
          <a href="/project/create">+ add</a>
        </div>
      )
    }
    {
      !user && (
        <div>
          <p>you must be logged in</p>
          <GithubLogin client:load />
        </div>
      )
    }
  </main>
</PageLayout>
