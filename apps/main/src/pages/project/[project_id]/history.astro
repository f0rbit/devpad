---
import { getProject, rethrow } from "@/utils/api-client";
import PageLayout from "@/layouts/PageLayout.astro";
import ProjectLayout from "@/layouts/ProjectLayout.astro";
import HistoryTimeline from "@/components/solid/HistoryTimeline";

const project_id = Astro.params.project_id!;

const guard = await getProject(Astro);
if (guard instanceof Response) return guard;
const { client, project } = guard;

const history_result = await client.projects.history(project.id);
if (!history_result.ok) return rethrow(history_result.error);
const history = history_result.value;
---

<PageLayout title={`History - ${project_id}`}>
	<ProjectLayout project_id={project_id}>
		<h5>timeline</h5>
		<br />
		<HistoryTimeline actions={history} view="project" client:load />
	</ProjectLayout>
</PageLayout>
